{% extends 'base.html' %}

{% block content %}
<section class="py-5">
    <div class="container">
        <div class="row gx-5">
            <aside class="col-lg-6">
                <div class="border rounded-4 mb-3 d-flex justify-content-center">
                    <!-- Ảnh chi tiết -->
                    <a data-fslightbox="mygalley" class="rounded-4" target="_blank" data-type="image"
                        href="{{ product.image.url }}">
                        <img style="max-width: 100%; max-height: 100vh; margin: auto;" class="rounded-4 fit"
                            src="{{ product.image.url }}" />
                    </a>
                </div>
                <!-- <div class="d-flex justify-content-center mb-3 ">
                    <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image"
                       href="../img/Product1_1.jpg"
                       class="item-thumb" id="image-2-phu">
                        <img width="60" height="60" class="rounded-2"
                             src="../img/Product1_1.jpg"/>
                    </a>
                    <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image"
                       href="../img/Product1_2.jpg"
                       class="item-thumb">
                        <img width="60" height="60" class="rounded-2"
                             src="../img/Product1_2.jpg"/>
                    </a>
                    <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image"
                       href="../img/Product1_3.jpg"
                       class="item-thumb">
                        <img width="60" height="60" class="rounded-2"
                             src="../img/Product1_3.jpg"/>
                    </a>
                    <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image"
                       href="../img/Product1_4.jpg"
                       class="item-thumb">
                        <img width="60" height="60" class="rounded-2"
                             src="../img/Product1_4.jpg"/>
                    </a>
                    <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image"
                       href="../img/Product1_5.jpg"
                       class="item-thumb">
                        <img width="60" height="60" class="rounded-2"
                             src="../img/Product1_5.jpg"/>
                    </a>
                </div> -->
                <!-- thumbs-wrap.// -->
                <!-- gallery-wrap .end// -->
            </aside>
            <main class="col-lg-6">
                <div class="ps-lg-3">
                    <h4 class="title text-dark">
                        {{ product.name }}
                    </h4>
                    <div class="d-flex flex-row my-3">
                        <!-- Xếp hạng -->
                        <div class="text-warning mb-1 me-2">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <span class="ms-1"> 5.0 </span>
                        </div>
                        <!-- Lượt mua -->
                        <span class="text-muted"><i class="fas fa-shopping-basket fa-sm mx-1"></i>Đã bán 145</span>
                        <span class="text-success ms-2">Còn Hàng</span>
                    </div>
                    <!-- Giá tiền -->
                    <div class="mb-3">
                        <span class="h5">
                            <i class="fa-solid fa-dong-sign fa-2xs"></i>
                            {{ price }}
                        </span>
                    </div>

                    <p>
                        {{ description.0 }}
                    </p>
                    <hr />
                    <!--Số lượng, Mua ngay, Thêm vào giỏ hàng-->
                    <div class="row mb-4">

                        <label class="mb-2 d-block col-3">Số lượng</label>
                        <div class="input-group mb-3 col-9" style="width: 170px;">
                            <button class="btn btn-white border border-secondary px-3" type="button" id="button-addon1"
                                data-mdb-ripple-color="dark">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input 
                                type="text" 
                                class="form-control text-center border border-secondary" 
                                placeholder="1"
                                aria-label="Example text with button addon" 
                                aria-describedby="button-addon1" 
                                id="quantity-input" 
                                value="1"/>
                            <button class="btn btn-white border border-secondary px-3" type="button" id="button-addon2"
                                data-mdb-ripple-color="dark">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <!-- </div>-->
                    </div>
                    <a href="#" class="btn btn-warning border border-secondary py-2 " style="background-color: #ff253a">
                        Mua ngay </a>
                    <button 
                        type="button" 
                        value="{{ product.id }}"
                        id="add-cart"
                        class="btn btn-success border border-secondary py-2"
                    >
                        <i class="me-1 fa fa-shopping-basket"> </i> Thêm vào giỏ hàng
                    </button>
                    <a href="#" class="btn btn-light border border-secondary py-2 px-3">
                        <i class="fa-regular fa-heart fa-beat-fade"></i>
                    </a>
                </div>
            </main>
        </div>
    </div>
</section>
<!-- content -->

<section class="bg-light border-top py-4">
    <div class="container">
        <div class="row gx-4">
            <div class="col-lg-8 mb-4">
                <div class="border rounded-2 px-3 py-2 bg-white">
                    <!-- Pills navs -->
                    <ul class="nav nav-pills nav-justified mb-3" id="ex1" role="tablist">
                        <li class="nav-item d-flex" role="presentation">
                            <a class="nav-link-1 d-flex align-items-center justify-content-start w-100" id="ex1-tab-1"
                                data-mdb-toggle="pill" href="#ex1-pills-1" role="tab" aria-controls="ex1-pills-1"
                                aria-selected="true"
                                style="font-weight: 500; font-size: 1.2rem; padding: 0; color: black">
                                CHI TIẾT SẢN PHẨM
                            </a>
                        </li>

                    </ul>
                    <!-- Pills navs -->

                    <!-- Pills content -->
                    <div class="tab-content" id="ex1-content">
                        <div id="specification-item-231244" class="specification-item">
                            <div class="accordion" id="specificationAccordion">
                                {% for con in config %}
                                <div class="accordion-item">
                                    {% for key in con.keys %}
                                    <h2 class="accordion-header" id="{{ key }}">
                                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#collapse1" aria-expanded="true" aria-controls="collapse1">
                                            <strong>{{ key }}</strong>
                                        </button>
                                    </h2>
                                    <div id="collapse1" class="accordion-collapse collapse show"
                                        aria-labelledby="{{ key }}" data-bs-parent="#specificationAccordion">
                                        <div class="accordion-body">
                                            <ul class="list-unstyled">
                                                {% for value in con.values %}
                                                {% for val in value %}
                                                {% for k, v in val.items %}
                                                <li class="row">
                                                    <div class="col-4"><strong>{{ k }}:</strong></div>
                                                    <div class="col-8"><span>{{ v }}</span></div>
                                                </li>
                                                {% endfor %}
                                                {% endfor %}
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    </div>
                                    {% endfor%}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <!-- Pills content -->
                    <a class="nav-link-1 d-flex align-items-center justify-content-start w-100" id="ex1-tab-2"
                        data-mdb-toggle="pill" href="#ex1-pills-1" role="tab" aria-controls="ex1-pills-1"
                        aria-selected="true" style="font-weight: 500; font-size: 1.2rem; padding: 0; color: black">
                        MÔ TẢ SẢN PHẨM
                    </a>
                    <div id="content" class="content-limited mt-2">
                        {% for des in description %}
                        <p> {{ des }}</p>
                        {% endfor%}
                    </div>
                    <!--                    nút xem thêm-->
                    <button id="toggleContent">Xem thêm</button>
                    <script>
                        document.getElementById('toggleContent').addEventListener('click', function () {
                            const content = document.getElementById('content');
                            const isLimited = content.classList.toggle('content-limited');

                            if (isLimited) {
                                this.textContent = 'Xem thêm';
                            } else {
                                this.textContent = 'Thu gọn';
                            }
                        });
                    </script>
                </div>
            </div>
            <!--Các sản phẩm khác-->



            <div class="col-lg-4">
                <div class="px-0 border rounded-2 shadow-0">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Sản phẩm liên quan</h5>
                            <div class="d-flex mb-3">
                                <a href="#" class="me-3">
                                    <img src="../img/Product2_1.jpg" style="min-width: 96px; height: 96px;"
                                        class="img-md img-thumbnail" />
                                </a>
                                <div class="info">
                                    <a href="#" class="nav-link mb-1">
                                        Laptop Apple MacBook Air 13 inch M3 8GB/256GB
                                    </a>
                                    <strong class="text-dark">
                                        <i class="fa-solid fa-dong-sign fa-2xs"></i>
                                        27.090.000
                                    </strong>
                                </div>
                            </div>

                            <div class="d-flex mb-3">
                                <a href="#" class="me-3">
                                    <img src="../img/Product3_1.jpg" style="min-width: 96px; height: 96px;"
                                        class="img-md img-thumbnail" />
                                </a>
                                <div class="info">
                                    <a href="#" class="nav-link mb-1">
                                        Laptop Apple MacBook Pro 16 inch M3 Pro 18GB/512GB
                                    </a>
                                    <strong class="text-dark">
                                        <i class="fa-solid fa-dong-sign fa-2xs"></i>
                                        64.490.000
                                    </strong>
                                </div>
                            </div>

                            <div class="d-flex mb-3">
                                <a href="#" class="me-3">
                                    <img src="../img/Product4_1.jpg" style="min-width: 96px; height: 96px;"
                                        class="img-md img-thumbnail" />
                                </a>
                                <div class="info">
                                    <a href="#" class="nav-link mb-1"> Laptop Apple MacBook Pro 14 inch M3 16GB/512GB
                                    </a>
                                    <strong class="text-dark">
                                        <i class="fa-solid fa-dong-sign fa-2xs"></i>
                                        44.490.000
                                    </strong>
                                </div>
                            </div>

                            <div class="d-flex">
                                <a href="#" class="me-3">
                                    <img src="../img/Product5_1.jpg" style="min-width: 96px; height: 96px;"
                                        class="img-md img-thumbnail" />
                                </a>
                                <div class="info">
                                    <a href="#" class="nav-link mb-1"> Laptop HP Pavilion 15 eg3093TU i5
                                        1335U/16GB/512GB/Win11 </a>
                                    <strong class="text-dark">
                                        <i class="fa-solid fa-dong-sign fa-2xs"></i>
                                        18.490.000
                                    </strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!--Đánh giá sản phẩm-->
<section class="bg-light border-top py-4">
    <div class="container">
        <div class="row gx-4">
            <div class="col-lg-8 mb-4">
                <div class="border rounded-2 px-3 py-2 bg-white">
                    <div class="comment_content">
                        <a class="nav-link-1 d-flex align-items-center justify-content-start w-100" id="ex1-tab-3"
                            data-mdb-toggle="pill" href="#ex1-pills-1" role="tab" aria-controls="ex1-pills-1"
                            aria-selected="true" style="font-weight: 500; font-size: 1.2rem; padding: 0; color: black">
                            ĐÁNH GIÁ SẢN PHẨM
                        </a>
                        <ul class="comment-list">
                            <li class="mb-4 row">
                                <!--                                Khách hàng-->
                                <div class="comment-header col-2">
                                    <div class="comment-name" style="font-weight: bold">Như</div>
                                    <div class="comment-date">09/09/2024</div>
                                </div>
                                <!--                                rating-->
                                <div class="comment-content col-10">
                                    <div class="rating-box mt-2">
                                        <div class="text-warning mb-1 me-2">
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                        </div>
                                    </div>
                                    <!--                                    Đánh giá-->
                                    <div class="mt-2">
                                        Cảm ơn vì đã nhiệt tình hỗ trợ. Đập hộp cái MacBook thứ nhất bị vấn đề và được
                                        đập hộp cái thứ 2 ngay và luôn. Các bạn nhân viên vẫn
                                        rất có tâm, nhiệt tình và vui vẻ mặc dù cận giờ đóng cửa. Trước đó bạn nhân viên
                                        online cũng cố gắng hỗ trợ mấy lượt để giữ hàng cho mình tại shop. Mình đánh giá
                                        5 sao cộng và chúc các bạn được nhiều sức khoẻ và được nhiều khách hàng yêu quý.
                                    </div>
                                </div>

                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    $(document).ready(function() {
        $('#button-addon1').on('click', function() {
            let currentValue = parseInt($('#quantity-input').val())
            if (currentValue > 1) {
                $('#quantity-input').val(currentValue - 1);
            }
        })
        $('#button-addon2').on('click', function() {
            let currentValue = parseInt($('#quantity-input').val())
            $('#quantity-input').val(currentValue + 1)
        })
    })

    $(document).on('click', '#add-cart', function(e) {
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: '{% url "cart_add" %}',
            data: {
                product_id: $('#add-cart').val(),
                product_qty: $('#quantity-input').val(),
                csrfmiddlewaretoken: '{{ csrf_token }}',
                action: 'post'
            },

            success: function(json) {
                console.log(json)
                document.getElementById('cart_quantity')
                    .textContent = json.qty  
            },

            error: function(xhr, errmsg, err) {
                
            }
        })
    })
</script>

{% endblock %}